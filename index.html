<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Telepub Mini App с Wink Player</title>
<style>
  body {
    font-family: sans-serif;
    text-align: center;
    padding: 20px;
    background-color: #f9f9f9;
  }
  .video-container {
    max-width: 640px;
    margin: 0 auto;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    position: relative;
    transition: all 0.3s ease;
  }
  .video-container.fullscreen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 9999;
    background-color: black;
  }
  iframe {
    width: 100%;
    height: 360px;
    border: none;
  }
  .btn {
    margin-top: 12px;
  }
  .btn a, .btn button {
    padding: 12px 28px;
    background-color: #ff3b30;
    color: white;
    font-size: 18px;
    border-radius: 8px;
    text-decoration: none;
    display: inline-block;
    border: none;
    cursor: pointer;
  }
  .btn a:hover, .btn button:hover {
    background-color: #e02c20;
  }
  .fullscreen-btn {
    margin-left: 10px;
  }
</style>
</head>
<body>

<h2>Telepub Mini App — Великолепный век, серия 1</h2>

<!-- Контейнер для Wink Player -->
<div id="wink-player" class="video-container"></div>

<!-- Кнопки под видео -->
<div class="btn">
  <a href="https://brand-sense.github.io/tma_traffic_test/?utm_source=telegram&utm_medium=miniapp&utm_campaign=test_tma&utm_content=btn1"
     target="_blank">
    Купить
  </a>
  <button class="fullscreen-btn" onclick="toggleFullscreen()">Полный экран</button>
</div>

<!-- UMD SDK Wink -->
<script src="https://static-adtech.wink.ru/embed-sdk/winkembed.umd.js"></script>
<script>
  const container = document.getElementById("wink-player");

  // Вставка плеера через Wink SDK
  const frame = WinkEmbedSDK.api.insertFrame(container, {
    trackId: 149613484,   // Великолепный век, серия 1
    partnerId: 'P0',
    frameOptions: {
      width: "100%",
      height: "360px",
      allowFullscreen: true
    }
  });

  const { events } = WinkEmbedSDK;

  frame.on(events.AD_END, ({ ad_place_type, ad_position, duration }) => {
    console.log("Реклама завершена:", ad_place_type, ad_position, duration);
  });

  frame.on(events.PLAYBACK_END, ({ content_id, ads_shown, position }) => {
    console.log("Видео завершено:", content_id, ads_shown, position);
  });

  // Функция для раскрытия видео на полный экран
  function toggleFullscreen() {
    container.classList.toggle("fullscreen");
  }
</script>

</body>
</html>
